(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3720:function(e,t,s){Promise.resolve().then(s.bind(s,3352))},3352:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var r=s(7437),a=s(2265),l=s(2141);function n(e){let{onLoginSuccess:t}=e,[s,n]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,x]=(0,a.useState)(!1),m=async e=>{e.preventDefault(),c(""),x(!0);try{let{data:e,error:r}=await l.O.auth.signInWithPassword({email:s,password:i});if(r){c(r.message||"Invalid email or password"),x(!1);return}e.user&&t()}catch(e){c(e.message||"An error occurred during login"),x(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Login"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Enter your credentials to access the admin panel"})]}),(0,r.jsxs)("form",{onSubmit:m,className:"space-y-6",children:[d&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:d}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,r.jsx)("input",{id:"email",type:"email",value:s,onChange:e=>n(e.target.value),required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",placeholder:"admin@example.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,r.jsx)("input",{id:"password",type:"password",value:i,onChange:e=>o(e.target.value),required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",placeholder:"Enter your password"})]}),(0,r.jsx)("button",{type:"submit",disabled:u,className:"w-full rounded-lg bg-[#36498C] px-4 py-2 text-sm font-semibold text-white hover:bg-[#36498C]/90 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Signing in...":"Sign In"})]})]})})}var i=s(9385);function o(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!0);(0,a.useEffect)(()=>{x()},[]);let o=async e=>{let{data:t}=await l.O.from("courses").select("id").order("Business"===e?"business_relevancy":"Restaurant"===e?"restaurant_relevancy":"fleet_relevancy",{ascending:!0,nullsFirst:!1}).limit(10);return(t||[]).map(e=>e.id)},x=async()=>{try{var e,s,r,a,d,c;let n,u,x;let m=(await (0,i.V3)()).length,[g,p]=await Promise.all([l.O.from("leads").select("id",{count:"exact"}),l.O.from("signups").select("id, created_at, course_id",{count:"exact"})]),h=g.count||(null===(e=g.data)||void 0===e?void 0:e.length)||0,y=p.count||(null===(s=p.data)||void 0===s?void 0:s.length)||0,f=await l.O.from("signups").select("*, courses(title)").order("created_at",{ascending:!1}).limit(5),b=await l.O.from("signups").select("course_id, courses(title)").not("course_id","is",null),v={};null===(r=b.data)||void 0===r||r.forEach(e=>{if(e.course_id){if(!v[e.course_id]){var t;v[e.course_id]={count:0,title:(null===(t=e.courses)||void 0===t?void 0:t.title)||"Unknown Course"}}v[e.course_id].count++}});let j=Object.entries(v).map(e=>{let[t,s]=e;return{course_id:t,...s}}).sort((e,t)=>t.count-e.count).slice(0,5),[N,w,C]=await Promise.all([o("Business"),o("Restaurant"),o("Fleet")]),_=[...N,...w,...C];n=_.length>0?await l.O.from("signups").select("landing_tag, course_id").in("course_id",_):{data:[],error:null};let k={};null===(a=n.data)||void 0===a||a.forEach(e=>{let t=e.landing_tag||"Unknown";k[t]=(k[t]||0)+1});let S=Object.entries(k).map(e=>{let[t,s]=e;return{tag:t,count:s}}).sort((e,t)=>t.count-e.count);u=_.length>0?await l.O.from("signups").select("utm_source, course_id").in("course_id",_).not("utm_source","is",null):{data:[],error:null};let E={};null===(d=u.data)||void 0===d||d.forEach(e=>{let t=e.utm_source||"Unknown";E[t]=(E[t]||0)+1});let D=Object.entries(E).map(e=>{let[t,s]=e;return{source:t,count:s}}).sort((e,t)=>t.count-e.count).slice(0,10),L=new Date;L.setMonth(L.getMonth()-6),x=_.length>0?await l.O.from("signups").select("created_at, course_id").in("course_id",_).gte("created_at",L.toISOString()):{data:[],error:null};let T={};null===(c=x.data)||void 0===c||c.forEach(e=>{let t=new Date(e.created_at),s="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"));T[s]=(T[s]||0)+1});let O=Object.entries(T).map(e=>{let[t,s]=e;return{month:t,count:s}}).sort((e,t)=>e.month.localeCompare(t.month));t({totalCourses:m,totalLeads:h,totalSignups:y,recentSignups:f.data||[],popularCourses:j,signupsByTag:S,topUTMSources:D,signupsByMonth:O})}catch(e){console.error("Error fetching stats:",e)}finally{n(!1)}};if(s)return(0,r.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading dashboard..."});let m=e&&e.totalLeads>0?(e.totalSignups/e.totalLeads*100).toFixed(1):"0.0";return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsx)(d,{title:"Total Courses",value:(null==e?void 0:e.totalCourses)||0,icon:"\uD83D\uDCDA",color:"blue"}),(0,r.jsx)(d,{title:"Total Leads",value:(null==e?void 0:e.totalLeads)||0,icon:"\uD83D\uDC65",color:"green"}),(0,r.jsx)(d,{title:"Total Signups",value:(null==e?void 0:e.totalSignups)||0,icon:"✅",color:"purple"}),(0,r.jsx)(d,{title:"Conversion Rate",value:"".concat(m,"%"),icon:"\uD83D\uDCC8",color:"yellow"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,r.jsx)(c,{signups:(null==e?void 0:e.recentSignups)||[]}),(0,r.jsx)(u,{courses:(null==e?void 0:e.popularCourses)||[]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Analytics & Insights"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Analytics of all courses"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Signups by Landing Tag"}),(null==e?void 0:e.signupsByTag)&&0===e.signupsByTag.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No data available"}):(0,r.jsx)("div",{className:"space-y-3",children:null==e?void 0:e.signupsByTag.map(t=>{let s=e.signupsByTag.reduce((e,t)=>e+t.count,0),a=s>0?(t.count/s*100).toFixed(1):0;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:t.tag}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[t.count," (",a,"%)"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-[#36498C] h-2 rounded-full",style:{width:"".concat(a,"%")}})})]},t.tag)})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top UTM Sources"}),(null==e?void 0:e.topUTMSources)&&0===e.topUTMSources.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No UTM source data available"}):(0,r.jsx)("div",{className:"space-y-2",children:null==e?void 0:e.topUTMSources.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-400 mr-3 w-6",children:["#",t+1]}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:e.source})]}),(0,r.jsxs)("span",{className:"text-sm text-gray-600 font-medium",children:[e.count," signups"]})]},e.source))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Signups Trend (Last 6 Months)"}),(null==e?void 0:e.signupsByMonth)&&0===e.signupsByMonth.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No data available"}):(0,r.jsx)("div",{className:"space-y-2",children:null==e?void 0:e.signupsByMonth.map(t=>{let s=Math.max(...(e.signupsByMonth||[]).map(e=>e.count)),a=s>0?t.count/s*100:0,l=new Date(t.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:l}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[t.count," signups"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-[#34B682] h-2 rounded-full",style:{width:"".concat(a,"%")}})})]},t.month)})})]})]})}function d(e){let{title:t,value:s,icon:a,color:l}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:t}),(0,r.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:s})]}),(0,r.jsx)("div",{className:"text-4xl",children:a})]})})}function c(e){let{signups:t}=e;return(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Signups"}),0===t.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No signups yet"}):(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>{var t;return(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.email})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(null===(t=e.courses)||void 0===t?void 0:t.title)&&(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.courses.title})]})]},e.id)})})]})}function u(e){let{courses:t}=e;return(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Popular Courses"}),0===t.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No signup data yet"}):(0,r.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:"text-lg font-bold text-gray-400 mr-3 w-6",children:["#",t+1]}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title})]}),(0,r.jsxs)("span",{className:"text-sm text-gray-600 font-medium",children:[e.count," signups"]})]},e.course_id))})]})}function x(e){let{course:t,onSave:s,onCancel:l}=e,[n,i]=(0,a.useState)(!1),[o,d]=(0,a.useState)({title:"",description:"",headline:"",bullet_points:"",provider:"",level:"",duration:"",tag:"",external_url:"",rating:"",reviews:"",course_type:"",key_skills:"",modules:"",instructors:"",effort:"",languages:"",free_trial:"",price_label:"",source:"admin",signup_enabled:!0});(0,a.useEffect)(()=>{if(t){var e,s,r,a,l;d({title:t.title||"",description:t.description||"",headline:t.headline||"",bullet_points:(null===(e=t.bullet_points)||void 0===e?void 0:e.join("\n"))||"",provider:t.provider||"",level:t.level||"",duration:t.duration||"",tag:(null===(s=t.tags)||void 0===s?void 0:s[0])||"",external_url:t.external_url||"",rating:(null===(r=t.rating)||void 0===r?void 0:r.toString())||"",reviews:(null===(a=t.reviews)||void 0===a?void 0:a.toString())||"",course_type:t.course_type||"",key_skills:t.key_skills||"",modules:t.modules||"",instructors:t.instructors||"",effort:t.effort||"",languages:t.languages||"",free_trial:t.free_trial||"",price_label:t.price_label||"",source:t.source||"admin",signup_enabled:null===(l=t.signup_enabled)||void 0===l||l})}},[t]);let c=async e=>{e.preventDefault(),i(!0);try{let e=o.bullet_points?o.bullet_points.split("\n").filter(e=>e.trim()):null,r={title:o.title,description:o.description||null,headline:o.headline||null,bullet_points:e,provider:o.provider||null,level:o.level||null,duration:o.duration||null,tag:o.tag||null,external_url:o.external_url||null,rating:o.rating?parseFloat(o.rating):null,reviews:o.reviews?parseInt(o.reviews):null,course_type:o.course_type||null,key_skills:o.key_skills||null,modules:o.modules||null,instructors:o.instructors||null,effort:o.effort||null,languages:o.languages||null,free_trial:o.free_trial||null,price_label:o.price_label||null,source:o.source,signup_enabled:o.signup_enabled},a=t?"/api/admin/courses/".concat(t.id):"/api/admin/courses",l=await fetch(a,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to save course")}alert(t?"Course updated successfully!":"Course created successfully!"),s()}catch(e){console.error("Error saving course:",e),alert("Failed to save course: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{i(!1)}};return(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:t?"Edit Course":"Add New Course"}),(0,r.jsxs)("form",{onSubmit:c,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,r.jsx)("input",{type:"text",required:!0,value:o.title,onChange:e=>d({...o,title:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{value:o.description,onChange:e=>d({...o,description:e.target.value}),rows:3,className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Headline (max 60 chars)"}),(0,r.jsx)("input",{type:"text",maxLength:60,value:o.headline,onChange:e=>d({...o,headline:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider"}),(0,r.jsx)("input",{type:"text",value:o.provider,onChange:e=>d({...o,provider:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tag *"}),(0,r.jsxs)("select",{required:!0,value:o.tag,onChange:e=>d({...o,tag:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"",children:"Select a tag"}),(0,r.jsx)("option",{value:"Business",children:"Business"}),(0,r.jsx)("option",{value:"Restaurant",children:"Restaurant"}),(0,r.jsx)("option",{value:"Fleet",children:"Fleet"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Level"}),(0,r.jsxs)("select",{value:o.level,onChange:e=>d({...o,level:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"",children:"Select level"}),(0,r.jsx)("option",{value:"Beginner",children:"Beginner"}),(0,r.jsx)("option",{value:"Intermediate",children:"Intermediate"}),(0,r.jsx)("option",{value:"Advanced",children:"Advanced"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),(0,r.jsx)("input",{type:"text",placeholder:"e.g., 4 weeks, 8 hours",value:o.duration,onChange:e=>d({...o,duration:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"External URL"}),(0,r.jsx)("input",{type:"url",value:o.external_url,onChange:e=>d({...o,external_url:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rating (1-5)"}),(0,r.jsx)("input",{type:"number",step:"0.1",min:"1",max:"5",value:o.rating,onChange:e=>d({...o,rating:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Reviews"}),(0,r.jsx)("input",{type:"number",value:o.reviews,onChange:e=>d({...o,reviews:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Label"}),(0,r.jsx)("input",{type:"text",placeholder:"e.g., Free, $99, $199/month",value:o.price_label,onChange:e=>d({...o,price_label:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Free Trial"}),(0,r.jsx)("input",{type:"text",placeholder:"e.g., 7-day free trial",value:o.free_trial,onChange:e=>d({...o,free_trial:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bullet Points (one per line)"}),(0,r.jsx)("textarea",{value:o.bullet_points,onChange:e=>d({...o,bullet_points:e.target.value}),rows:4,placeholder:"Enter bullet points, one per line",className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course Type"}),(0,r.jsx)("input",{type:"text",value:o.course_type,onChange:e=>d({...o,course_type:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Skills"}),(0,r.jsx)("input",{type:"text",value:o.key_skills,onChange:e=>d({...o,key_skills:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modules"}),(0,r.jsx)("input",{type:"text",value:o.modules,onChange:e=>d({...o,modules:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructors"}),(0,r.jsx)("input",{type:"text",value:o.instructors,onChange:e=>d({...o,instructors:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effort"}),(0,r.jsx)("input",{type:"text",placeholder:"e.g., 5 hours/week",value:o.effort,onChange:e=>d({...o,effort:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Languages"}),(0,r.jsx)("input",{type:"text",placeholder:"e.g., English, Spanish",value:o.languages,onChange:e=>d({...o,languages:e.target.value}),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-[#36498C] focus:outline-none focus:ring-1 focus:ring-[#36498C]"})]})]}),(0,r.jsx)("div",{className:"flex gap-6",children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:o.signup_enabled,onChange:e=>d({...o,signup_enabled:e.target.checked}),className:"rounded border-gray-300 text-[#36498C] focus:ring-[#36498C]"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Signup Enabled"})]})}),(0,r.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("button",{type:"button",onClick:l,className:"rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:n,className:"rounded-md bg-[#36498C] px-4 py-2 text-sm font-medium text-white hover:bg-[#36498C]/90 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":t?"Update Course":"Create Course"})]})]})]})}function m(e){let{courses:t,onEdit:s,onDelete:a}=e;return 0===t.length?(0,r.jsx)("div",{className:"text-center py-12 text-gray-600",children:'No courses found. Click "Add New Course" to get started.'}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 border border-gray-200 rounded-lg",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Provider"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tag"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>{var t;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),e.description&&(0,r.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.description})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.provider||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:(null===(t=e.tags)||void 0===t?void 0:t[0])||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.level||"-"}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>s(e),className:"text-[#36498C] hover:text-[#36498C]/80 mr-4",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>a(e.id),className:"text-red-600 hover:text-red-800",children:"Delete"})]})]},e.id)})})]})})}function g(){let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)([]),[n,o]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null),[u,g]=(0,a.useState)(!1),[p,h]=(0,a.useState)(""),[y,f]=(0,a.useState)("all"),[b,v]=(0,a.useState)("all");(0,a.useEffect)(()=>{j()},[]),(0,a.useEffect)(()=>{N()},[e,p,y,b]);let j=async()=>{try{o(!0);let e=await (0,i.V3)();t(e)}catch(e){console.error("Error fetching courses:",e),alert("Failed to load courses. Please check the console for details.")}finally{o(!1)}},N=()=>{let t=[...e];p&&(t=t.filter(e=>{var t,s;return e.title.toLowerCase().includes(p.toLowerCase())||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase()))||(null===(s=e.provider)||void 0===s?void 0:s.toLowerCase().includes(p.toLowerCase()))})),"all"!==y&&(t=t.filter(e=>{var t;return null===(t=e.tags)||void 0===t?void 0:t.includes(y)})),"all"!==b&&(t=t.filter(e=>e.level===b)),l(t)},w=async e=>{if(confirm("Are you sure you want to delete this course?"))try{if(!(await fetch("/api/admin/courses/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete course");await j(),alert("Course deleted successfully")}catch(e){console.error("Error deleting course:",e),alert("Failed to delete course. Please check the console for details.")}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Course Management"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[s.length," of ",e.length," courses"]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Blob([[["Title","Provider","Tag","Level","Rating","URL"],...s.map(e=>{var t,s;return['"'.concat(e.title,'"'),'"'.concat(e.provider||"",'"'),(null===(t=e.tags)||void 0===t?void 0:t[0])||"",e.level||"",(null===(s=e.rating)||void 0===s?void 0:s.toString())||"",e.external_url||""]})].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="courses-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),URL.revokeObjectURL(t)},disabled:0===s.length,className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Export CSV"}),(0,r.jsx)("button",{onClick:()=>g(!0),className:"rounded-lg bg-[#36498C] px-4 py-2 text-sm font-semibold text-white hover:bg-[#36498C]/90",children:"Add New Course"})]})]}),u?(0,r.jsx)(x,{course:d,onSave:()=>{j(),g(!1),c(null)},onCancel:()=>{g(!1),c(null)}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Search"}),(0,r.jsx)("input",{type:"text",placeholder:"Search courses...",value:p,onChange:e=>h(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tag"}),(0,r.jsxs)("select",{value:y,onChange:e=>f(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"all",children:"All Tags"}),(0,r.jsx)("option",{value:"Business",children:"Business"}),(0,r.jsx)("option",{value:"Restaurant",children:"Restaurant"}),(0,r.jsx)("option",{value:"Fleet",children:"Fleet"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Level"}),(0,r.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"all",children:"All Levels"}),(0,r.jsx)("option",{value:"Beginner",children:"Beginner"}),(0,r.jsx)("option",{value:"Intermediate",children:"Intermediate"}),(0,r.jsx)("option",{value:"Advanced",children:"Advanced"})]})]})]})}),n?(0,r.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading courses..."}):(0,r.jsx)(m,{courses:s,onEdit:e=>{c(e),g(!0)},onDelete:w})]})]})}function p(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)("all");(0,a.useEffect)(()=>{d()},[i]);let d=async()=>{try{n(!0);let e=l.O.from("leads").select("*").order("created_at",{ascending:!1}).limit(500);"all"!==i&&(e=e.eq("landing_tag",i));let{data:s,error:r}=await e;if(r)throw r;t(s||[])}catch(e){console.error("Error fetching leads:",e),alert("Failed to load leads. Please check the console for details.")}finally{n(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Leads Management"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.length," total leads"]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"all",children:"All Tags"}),(0,r.jsx)("option",{value:"Business",children:"Business"}),(0,r.jsx)("option",{value:"Restaurant",children:"Restaurant"}),(0,r.jsx)("option",{value:"Fleet",children:"Fleet"})]}),(0,r.jsx)("button",{onClick:()=>{let t=new Blob([[["Email","Role","Landing Tag","UTM Source","UTM Medium","UTM Campaign","Date"],...e.map(e=>[e.email,e.role||"",e.landing_tag,e.utm_source||"",e.utm_medium||"",e.utm_campaign||"",new Date(e.created_at).toLocaleDateString()])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="leads-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),URL.revokeObjectURL(s)},disabled:0===e.length,className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Export CSV"})]})]}),s?(0,r.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading leads..."}):0===e.length?(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:(0,r.jsx)("p",{className:"text-gray-600",children:"No leads found"})}):(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Landing Tag"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UTM Source"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UTM Medium"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UTM Campaign"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.role||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:e.landing_tag})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.utm_source||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.utm_medium||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.utm_campaign||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})})})]})}function h(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)("all");(0,a.useEffect)(()=>{d()},[i]);let d=async()=>{try{n(!0);let e=l.O.from("signups").select("*, courses(title)").order("created_at",{ascending:!1}).limit(500);"all"!==i&&(e=e.eq("landing_tag",i));let{data:s,error:r}=await e;if(r)throw r;t(s||[])}catch(e){console.error("Error fetching signups:",e),alert("Failed to load signups. Please check the console for details.")}finally{n(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Signups Management"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.length," recent signups"]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"all",children:"All Tags"}),(0,r.jsx)("option",{value:"Business",children:"Business"}),(0,r.jsx)("option",{value:"Restaurant",children:"Restaurant"}),(0,r.jsx)("option",{value:"Fleet",children:"Fleet"})]}),(0,r.jsx)("button",{onClick:()=>{let t=new Blob([[["Name","Email","Course","Landing Tag","UTM Source","UTM Medium","UTM Campaign","Date"],...e.map(e=>{var t;return['"'.concat(e.first_name," ").concat(e.last_name,'"'),e.email,(null===(t=e.courses)||void 0===t?void 0:t.title)||"",e.landing_tag,e.utm_source||"",e.utm_medium||"",e.utm_campaign||"",new Date(e.created_at).toLocaleDateString()]})].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="signups-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),URL.revokeObjectURL(s)},disabled:0===e.length,className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Export CSV"})]})]}),s?(0,r.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading signups..."}):0===e.length?(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:(0,r.jsx)("p",{className:"text-gray-600",children:"No signups found"})}):(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Landing Tag"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UTM Source"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{var t;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null===(t=e.courses)||void 0===t?void 0:t.title)||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:e.landing_tag})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.utm_source||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]},e.id)})})]})})})]})}var y=s(1581);function f(){let[e,t]=(0,a.useState)("Business"),[s,l]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[o,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{c()},[e]);let c=async()=>{try{i(!0);let t=await (0,y.A_)(e);l(t)}catch(e){console.error("❌ Error fetching courses:",e),l([])}finally{i(!1)}},u=async e=>{if(0===e||o)return;let t=[...s],r=t[e];t[e]=t[e-1],t[e-1]=r,await m(t)},x=async e=>{if(e===s.length-1||o)return;let t=[...s],r=t[e];t[e]=t[e+1],t[e+1]=r,await m(t)},m=async t=>{try{d(!0),console.log("\uD83D\uDCBE Saving order for ".concat(e," page")),console.log("\uD83D\uDCBE Courses to update:",t.map((e,t)=>({position:t+1,id:e.id,title:e.title})));let s=await fetch("/api/admin/courses/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:e,courses:t.map((e,t)=>({id:e.id,position:t+1}))})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update order")}let r=await s.json();console.log("✅ Order saved successfully:",r),await new Promise(e=>setTimeout(e,500)),await c(),alert("Order updated successfully! The course pages will now show courses in this order.")}catch(e){console.error("❌ Error saving order:",e),alert("Failed to update order: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{d(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Landing Page Management"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Edit exactly what appears on the courses pages"})]}),(0,r.jsxs)("select",{value:e,onChange:e=>t(e.target.value),className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 focus:border-[#36498C] focus:ring-1 focus:ring-[#36498C]",children:[(0,r.jsx)("option",{value:"Business",children:"Business"}),(0,r.jsx)("option",{value:"Restaurant",children:"Restaurant"}),(0,r.jsx)("option",{value:"Fleet",children:"Fleet"})]})]}),n?(0,r.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading courses..."}):0===s.length?(0,r.jsxs)("div",{className:"text-center py-12 text-gray-600",children:["No courses found for ",e," landing page."]}):(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-medium text-gray-500 uppercase",children:[(0,r.jsx)("div",{className:"col-span-1",children:"Rank"}),(0,r.jsx)("div",{className:"col-span-6",children:"Title"}),(0,r.jsx)("div",{className:"col-span-2",children:"Provider"}),(0,r.jsx)("div",{className:"col-span-3",children:"Actions"})]})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:s.map((e,t)=>(0,r.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors ".concat(t<3?"bg-blue-50":""),children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,r.jsx)("div",{className:"col-span-1",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-bold text-gray-900 min-w-[20px]",children:t+1}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("button",{onClick:()=>u(t),disabled:0===t||o,className:"text-gray-400 hover:text-[#36498C] disabled:opacity-30 disabled:cursor-not-allowed text-xs",title:"Move up",children:"↑"}),(0,r.jsx)("button",{onClick:()=>x(t),disabled:t===s.length-1||o,className:"text-gray-400 hover:text-[#36498C] disabled:opacity-30 disabled:cursor-not-allowed text-xs",title:"Move down",children:"↓"})]})]})}),(0,r.jsxs)("div",{className:"col-span-6",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:e.description||"No description"})]}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)("div",{className:"text-sm text-gray-700",children:e.provider||(0,r.jsx)("span",{className:"text-gray-400",children:"-"})})}),(0,r.jsx)("div",{className:"col-span-3",children:t<3&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["Top ",t+1]})})]})},e.id))})]})]})}function b(){let[e,t]=(0,a.useState)("dashboard"),[s,i]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{u();let{data:{subscription:e}}=l.O.auth.onAuthStateChange((e,t)=>{t?i(!0):i(!1)});return()=>{e.unsubscribe()}},[]);let u=async()=>{try{let{data:{session:e}}=await l.O.auth.getSession();i(!!e)}catch(e){console.error("Error checking auth:",e),i(!1)}finally{c(!1)}},x=async()=>{try{await l.O.auth.signOut(),i(!1)}catch(e){console.error("Error logging out:",e)}};return d?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-[#36498C] border-r-transparent"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):s?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Administration"}),(0,r.jsx)("button",{onClick:x,className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Logout"})]}),(0,r.jsx)("div",{className:"flex space-x-1 border-t border-gray-200",children:[{id:"dashboard",label:"Dashboard",icon:"\uD83D\uDCCA"},{id:"courses",label:"Courses",icon:"\uD83D\uDCDA"},{id:"landing-pages",label:"Landing Pages",icon:"\uD83C\uDFA8"},{id:"leads",label:"Leads",icon:"\uD83D\uDC65"},{id:"signups",label:"Signups",icon:"✅"}].map(s=>(0,r.jsxs)("button",{onClick:()=>t(s.id),className:"px-6 py-3 text-sm font-medium border-b-2 transition-colors ".concat(e===s.id?"border-[#36498C] text-[#36498C]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,r.jsx)("span",{className:"mr-2",children:s.icon}),s.label]},s.id))})]})}),(0,r.jsxs)("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:["dashboard"===e&&(0,r.jsx)(o,{}),"courses"===e&&(0,r.jsx)(g,{}),"landing-pages"===e&&(0,r.jsx)(f,{}),"leads"===e&&(0,r.jsx)(p,{}),"signups"===e&&(0,r.jsx)(h,{})]})]}):(0,r.jsx)(n,{onLoginSuccess:()=>{i(!0)}})}},9385:function(e,t,s){"use strict";s.d(t,{V3:function(){return n},Yt:function(){return l}});var r=s(2141);function a(e){var t,s;let r=e.course_type||null;return{id:String(e.id||""),title:String(e.title||""),description:String(e.description||""),headline:e.headline||null,bullet_points:Array.isArray(e.bullet_points)?e.bullet_points:null,provider:e.provider||null,level:e.level||"Beginner",duration:String(e.duration||""),tags:e.tag?[e.tag]:[],external_url:e.external_url||null,priority:Number(e.priority)||999,rating:e.rating?Number(e.rating):null,reviews:e.reviews?Number(e.reviews):null,course_type:r,key_skills:e.key_skills||null,modules:e.modules||null,instructors:e.instructors||null,effort:e.effort||null,languages:e.languages||null,price:e.free_trial||void 0,source:String(e.source||""),signup_enabled:!!(null===(t=e.signup_enabled)||void 0===t||t),is_featured:!!(null!==(s=e.is_featured)&&void 0!==s&&s),price_label:e.price_label||null,free_trial:e.free_trial||null,created_at:e.created_at||null,updated_at:e.updated_at||null}}async function l(e){try{let{data:t,error:s}=await r.O.from("courses").select("*").eq("id",e).maybeSingle();if(s)throw console.error("Error fetching course by ID:",s),s;if(!t)return null;return a(t)}catch(e){throw console.error("Error in getCourseById:",e),e}}async function n(){try{let{data:e,error:t}=await r.O.from("courses").select("*").order("priority",{ascending:!0,nullsFirst:!1});if(t)throw console.error("Error fetching all courses:",t),t;return(e||[]).map(a)}catch(e){throw console.error("Error in getAllCourses:",e),e}}}},function(e){e.O(0,[53,581,971,117,744],function(){return e(e.s=3720)}),_N_E=e.O()}]);