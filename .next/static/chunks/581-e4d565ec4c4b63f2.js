"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[581],{2141:function(e,o,r){r.d(o,{O:function(){return l}});var n=r(3053);let s="https://ktqjebihzkbhsvbqpbui.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt0cWplYmloemtiaHN2YnFwYnVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwNDQwNDksImV4cCI6MjA4MTYyMDA0OX0.VVd6upefHH2g23ijFyx5mv7uJJdt9Xuz9jUkL-Jn-F0";if(!s||!t)throw Error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let l=(0,n.eI)(s,t,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},1581:function(e,o,r){r.d(o,{A_:function(){return c},Yt:function(){return a},pp:function(){return i},testSupabaseConnection:function(){return l}});var n=r(2141);function s(e){var o,r;let n=e.type||e.course_type||null;return{id:String(e.id||""),title:String(e.title||""),description:String(e.description||""),headline:e.headline||null,bullet_points:Array.isArray(e.bullet_points)?e.bullet_points:null,provider:e.provider||null,level:e.level||"Beginner",duration:String(e.duration||""),tags:e.tag?[e.tag]:[],external_url:e.external_url||null,priority:Number(e.priority)||999,rating:e.rating?Number(e.rating):null,reviews:e.reviews?Number(e.reviews):null,course_type:n,key_skills:e.key_skills||null,modules:e.modules||null,instructors:e.instructors||null,effort:e.effort||null,languages:e.languages||null,price:e.free_trial||void 0,source:String(e.source||""),signup_enabled:!!(null===(o=e.signup_enabled)||void 0===o||o),is_featured:!!(null!==(r=e.is_featured)&&void 0!==r&&r),price_label:e.price_label||null,free_trial:e.free_trial||null,created_at:e.created_at||null,updated_at:e.updated_at||null}}async function t(){try{console.log("\uD83D\uDD0D RAW QUERY: Fetching ALL courses with no filters...");let r="https://ktqjebihzkbhsvbqpbui.supabase.co";console.log("\uD83D\uDD17 Supabase URL:",r?r.substring(0,30)+"...":"❌ MISSING"),console.log("\uD83D\uDD11 Anon Key:","✅ Set");let{data:s,error:t,count:l}=await n.O.from("courses").select("*",{count:"exact"}).limit(100);if(t){var e,o;return console.error("❌ RAW QUERY ERROR:",t),console.error("Error code:",t.code),console.error("Error message:",t.message),console.error("Error hint:",t.hint),console.error("Full error:",JSON.stringify(t,null,2)),("PGRST301"===t.code||(null===(e=t.message)||void 0===e?void 0:e.includes("permission"))||(null===(o=t.message)||void 0===o?void 0:o.includes("policy")))&&(console.error("\uD83D\uDD12 RLS ERROR: Row Level Security is blocking the query!"),console.error("Check your Supabase RLS policies for the courses table."),console.error("Go to Supabase Dashboard → Authentication → Policies → courses table"),console.error('Make sure "courses_select_public" policy exists and allows SELECT')),[]}return console.log("✅ RAW QUERY SUCCESS: Found ".concat((null==s?void 0:s.length)||0," courses (count: ").concat(l,")")),s&&s.length>0?(console.log("\uD83D\uDCCB Sample raw course data:",JSON.stringify(s[0],null,2)),console.log("\uD83D\uDCCB All column names:",Object.keys(s[0])),console.log("\uD83D\uDCCB Sample tag value:",s[0].tag),console.log("\uD83D\uDCCB Sample priority value:",s[0].priority)):(console.warn("⚠️ No courses found in database"),console.warn("This could mean:"),console.warn("1. No courses exist in THIS Supabase project"),console.warn("2. RLS policies are blocking the query (but no error shown)"),console.warn("3. Wrong Supabase project/credentials"),console.warn(""),console.warn("\uD83D\uDD0D VERIFICATION STEPS:"),console.warn("1. Go to Supabase Dashboard → Table Editor → courses"),console.warn("2. Check if courses exist there"),console.warn("3. Verify the Supabase URL matches:",r.substring(0,30)+"..."),console.warn("4. Check RLS policies: Dashboard → Authentication → Policies")),s||[]}catch(e){return console.error("❌ RAW QUERY EXCEPTION:",e),console.error("Exception message:",null==e?void 0:e.message),console.error("Exception stack:",null==e?void 0:e.stack),[]}}async function l(){console.log("\uD83E\uDDEA === TESTING SUPABASE CONNECTION ==="),console.log("Supabase URL:","✅ Set"),console.log("Supabase Key:","✅ Set");let e=await t();if(console.log("\uD83D\uDCCA Connection test result: ".concat(e.length," courses found")),e.length>0){let o=e[0];console.log("\uD83D\uDCCB Sample course columns:",Object.keys(o)),console.log("\uD83D\uDCCB Sample course tag value:",o.tag),console.log("\uD83D\uDCCB Sample course type column:",o.type||o.course_type||"NOT FOUND")}}async function u(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{includeHidden:r=!1,limit:t}=o,l="Business"===e?"business_relevancy":"Restaurant"===e?"restaurant_relevancy":"fleet_relevancy";console.log('\uD83C\uDFF7️ getCoursesByTagInternal: Fetching courses for tag "'.concat(e,'" (includeHidden: ').concat(r,", limit: ").concat(t||"none",")...")),console.log("\uD83C\uDFF7️ IMPORTANT: NO tag filter, NO signup_enabled filter - getting ALL courses sorted by ".concat(l)),console.log("\uD83C\uDFF7️ Ordering by: ".concat(l," (ascending, nullsFirst: false)"));let u=n.O.from("courses").select("*");u=u.order(l||"priority",{ascending:!0,nullsFirst:!1}),t&&(u=u.limit(t),console.log("\uD83C\uDFF7️ Limiting to ".concat(t," courses")));let{data:c,error:a}=await u;if(console.log("\uD83C\uDFF7️ Query executed: returned ".concat((null==c?void 0:c.length)||0," courses (limit was ").concat(t||"none",")")),c&&c.length>0&&console.log("\uD83C\uDFF7️ Relevancy scores for returned courses:",c.map(e=>({id:e.id,title:e.title,[l]:e[l],signup_enabled:e.signup_enabled}))),c&&t&&c.length>t&&console.error("❌ ERROR: Query returned ".concat(c.length," courses but limit was ").concat(t,"! This should not happen.")),a){console.error("❌ getCoursesByTagInternal DATABASE ERROR:",a),console.error("Error code:",a.code),console.error("Error message:",a.message),console.warn("⚠️ Falling back to priority-based ordering...");let e=n.O.from("courses").select("*");e=e.order("priority",{ascending:!0,nullsFirst:!1}),t&&(e=e.limit(t));let{data:o,error:r}=await e;if(r)return console.error("❌ Fallback query also failed:",r),[];let l=(o||[]).map(s);return console.log("\uD83C\uDFF7️ getCoursesByTagInternal (fallback): Returned ".concat(l.length," courses")),l}if(!c||0===c.length)return console.warn('⚠️ getCoursesByTagInternal: No courses found for tag "'.concat(e,'"')),[];let i=c.map(s);return t&&i.length>t&&(console.warn("⚠️ WARNING: Database returned ".concat(i.length," courses but limit is ").concat(t,". Truncating to ").concat(t,".")),i=i.slice(0,t)),console.log("\uD83C\uDFF7️ getCoursesByTagInternal: Successfully returned ".concat(i.length,' courses for tag "').concat(e,'" (limit was ').concat(t||"none",")")),i}catch(e){return console.error("❌ getCoursesByTagInternal EXCEPTION:",e),console.error("Exception message:",null==e?void 0:e.message),[]}}async function c(e){return u(e,{includeHidden:!0,limit:10})}async function a(e){try{console.log("\uD83D\uDD0D getCourseById: Fetching course ".concat(e,"..."));let{data:o,error:r}=await n.O.from("courses").select("*").eq("id",e).maybeSingle();if(r)return console.error("❌ getCourseById ERROR:",r),null;if(!o)return console.warn("⚠️ getCourseById: Course ".concat(e," not found")),null;return console.log("✅ getCourseById: Found course ".concat(e)),s(o)}catch(e){return console.error("❌ getCourseById EXCEPTION:",e),null}}async function i(){try{console.log("⭐ getFeaturedCourses: Fetching featured courses from database...");let{data:e,error:o}=await n.O.from("courses").select("*").eq("is_featured",!0).eq("signup_enabled",!0).order("priority",{ascending:!0,nullsFirst:!1});if(o)return console.error("❌ getFeaturedCourses DATABASE ERROR:",o),[];if(!e||0===e.length)return console.log("⭐ getFeaturedCourses: No featured courses found"),[];console.log("⭐ getFeaturedCourses: Database returned ".concat(e.length," featured courses"));let r=e.map(s);return console.log("⭐ getFeaturedCourses: Successfully returned ".concat(r.length," featured courses")),r}catch(e){return console.error("❌ getFeaturedCourses ERROR:",e),[]}}}}]);