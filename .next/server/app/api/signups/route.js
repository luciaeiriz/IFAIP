"use strict";(()=>{var e={};e.id=952,e.ids=[952],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6584:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>g,patchFetch:()=>_,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>c,staticGenerationAsyncStorage:()=>d});var r={};s.r(r),s.d(r,{POST:()=>l});var n=s(9303),i=s(8716),a=s(3131),u=s(7070),o=s(5662);async function l(e){try{let t=await e.json();if(!t.first_name||!t.last_name||!t.email||!t.course_id||!t.landing_tag)return u.NextResponse.json({error:"first_name, last_name, email, course_id, and landing_tag are required"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email))return u.NextResponse.json({error:"Invalid email format"},{status:400});if(!["Business","Restaurant","Fleet"].includes(t.landing_tag))return u.NextResponse.json({error:"Invalid landing_tag. Must be one of: Business, Restaurant, Fleet"},{status:400});let{data:s,error:r}=await o.O.from("courses").select("id, signup_enabled").eq("id",t.course_id).single();if(r||!s)return u.NextResponse.json({error:"Course not found"},{status:404});if(!s.signup_enabled)return u.NextResponse.json({error:"Signups are not enabled for this course"},{status:403});let n={first_name:t.first_name.trim(),last_name:t.last_name.trim(),email:t.email.trim().toLowerCase(),course_id:t.course_id,landing_tag:t.landing_tag,source:t.source?.trim()||null,utm_source:t.utm_source?.trim()||null,utm_medium:t.utm_medium?.trim()||null,utm_campaign:t.utm_campaign?.trim()||null,utm_term:t.utm_term?.trim()||null,utm_content:t.utm_content?.trim()||null},{data:i,error:a}=await o.O.from("signups").insert([n]).select().single();if(a)return console.error("Error creating signup:",a),u.NextResponse.json({error:a.message||"Failed to create signup"},{status:500});return u.NextResponse.json({success:!0,signup:i},{status:201})}catch(e){return console.error("Error in POST /api/signups:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/signups/route",pathname:"/api/signups",filename:"route",bundlePath:"app/api/signups/route"},resolvedPagePath:"/Users/lucia/Documents/GitHub/IFAIP/app/api/signups/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:c}=m,g="/api/signups/route";function _(){return(0,a.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:d})}},5662:(e,t,s)=>{s.d(t,{O:()=>a});var r=s(7857);let n="https://ktqjebihzkbhsvbqpbui.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt0cWplYmloemtiaHN2YnFwYnVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwNDQwNDksImV4cCI6MjA4MTYyMDA0OX0.VVd6upefHH2g23ijFyx5mv7uJJdt9Xuz9jUkL-Jn-F0";if(!n||!i)throw Error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let a=(0,r.eI)(n,i,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,972,857],()=>s(6584));module.exports=r})();